<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatGPT Email Assistant</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
</head>
<body>
    <div id="app">
        <!-- Settings Panel (shown when not configured) -->
        <div id="settings-panel" class="panel hidden">
            <h2>Settings</h2>
            <div class="form-group">
                <label for="api-key">OpenAI API Key</label>
                <input type="password" id="api-key" placeholder="sk-...">
                <small>Your API key is stored locally on this device only.</small>
            </div>
            <div class="form-group">
                <label for="system-instructions">Custom Instructions (Optional)</label>
                <textarea id="system-instructions" rows="4" placeholder="E.g., My boss prefers formal language, bullet points, and concise responses. Always sign off with 'Best regards'..."></textarea>
                <small>These instructions will be included with every request to ChatGPT.</small>
            </div>
            <div class="form-group">
                <label for="model-select">Model</label>
                <select id="model-select">
                    <option value="gpt-5.2">GPT-5.2 (Latest - Dec 2025)</option>
                    <option value="gpt-5.1">GPT-5.1</option>
                    <option value="gpt-5">GPT-5</option>
                    <option value="gpt-4.1">GPT-4.1</option>
                    <option value="gpt-4.1-mini">GPT-4.1 Mini (Fast/Affordable)</option>
                    <option value="gpt-4.1-nano">GPT-4.1 Nano (Fastest/Cheapest)</option>
                    <option value="gpt-4o">GPT-4o</option>
                    <option value="gpt-4o-mini">GPT-4o Mini (Faster/Cheaper)</option>
                    <option value="o1">o1 (Advanced Reasoning)</option>
                    <option value="o1-mini">o1 Mini (Fast Reasoning)</option>
                    <option value="o3-mini">o3 Mini (Reasoning)</option>
                </select>
            </div>
            <button id="save-settings" class="btn btn-primary">Save Settings</button>
        </div>

        <!-- Main Panel -->
        <div id="main-panel" class="panel hidden">
            <div class="header">
                <div class="header-title">
                    <div class="app-logo">GPT</div>
                    <h2>Email Assistant</h2>
                </div>
                <button id="open-settings" class="btn-icon" title="Settings">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 10a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm0-1a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                        <path d="M6.5 1a.5.5 0 0 0-.5.5v1.02a4.5 4.5 0 0 0-1.56.64l-.72-.72a.5.5 0 0 0-.71 0l-.7.7a.5.5 0 0 0 0 .71l.72.72A4.5 4.5 0 0 0 2.4 6H1.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h.9a4.5 4.5 0 0 0 .64 1.56l-.72.72a.5.5 0 0 0 0 .71l.7.7a.5.5 0 0 0 .71 0l.72-.72a4.5 4.5 0 0 0 1.56.64v.9a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-.9a4.5 4.5 0 0 0 1.56-.64l.72.72a.5.5 0 0 0 .71 0l.7-.7a.5.5 0 0 0 0-.71l-.72-.72A4.5 4.5 0 0 0 12.6 9h.9a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-.9a4.5 4.5 0 0 0-.64-1.56l.72-.72a.5.5 0 0 0 0-.71l-.7-.7a.5.5 0 0 0-.71 0l-.72.72A4.5 4.5 0 0 0 9 2.52V1.5a.5.5 0 0 0-.5-.5h-2z"/>
                    </svg>
                </button>
            </div>

            <!-- Email Info -->
            <div id="email-info" class="email-info">
                <div class="email-subject"></div>
                <div class="email-from"></div>
            </div>

            <!-- Action Buttons -->
            <div class="actions">
                <button id="btn-summarize" class="btn btn-action">Summarize</button>
                <button id="btn-reply" class="btn btn-action">Draft Reply</button>
                <button id="btn-action-items" class="btn btn-action">Action Items</button>
                <button id="btn-polish" class="btn btn-action">Analyze Reply</button>
            </div>

            <!-- Custom Prompt -->
            <div class="custom-prompt-section">
                <label for="custom-prompt">Custom Prompt</label>
                <textarea id="custom-prompt" rows="2" placeholder="Ask ChatGPT anything about this email..."></textarea>
                <button id="btn-custom" class="btn btn-secondary">Send Custom Prompt</button>
            </div>

            <!-- Response Area -->
            <div id="response-section" class="response-section hidden">
                <div class="response-header">
                    <h3>Response</h3>
                    <div class="response-actions">
                        <button id="btn-copy" class="btn-small" title="Copy to clipboard">Copy</button>
                        <button id="btn-insert" class="btn-small" title="Insert into email">Insert</button>
                    </div>
                </div>
                <div id="response-content" class="response-content"></div>

                <!-- Follow-up Input -->
                <div class="followup-section">
                    <textarea id="followup-input" rows="2" placeholder="Ask for changes... e.g., 'Make it shorter' or 'More formal tone'"></textarea>
                    <div class="followup-actions">
                        <button id="btn-followup" class="btn btn-secondary">Send Follow-up</button>
                        <button id="btn-new-conversation" class="btn-small btn-text" title="Start fresh">New Conversation</button>
                    </div>
                </div>
            </div>

            <!-- Loading Indicator -->
            <div id="loading" class="loading hidden">
                <div class="spinner"></div>
                <span>Thinking...</span>
            </div>

            <!-- Error Display -->
            <div id="error" class="error hidden"></div>
        </div>
    </div>

    <script src="taskpane.js"></script>
</body>
</html>
